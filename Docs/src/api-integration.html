<!DOCTYPE html>
<html lang="en">
  <head>
    @@include("partials/title-meta.html", {"title": "Redux"})
    @@include("partials/head-css.html")
  </head>

  <body
    data-topbar="dark"
    data-spy="scroll"
    data-target=".right-side-nav"
    data-offset="175"
  >
    <!-- Begin page -->
    <div id="layout-wrapper">
      @@include("partials/topbar.html") @@include("partials/sidebar.html")

      <!-- ============================================================== -->
      <!-- Start right Content here -->
      <!-- ============================================================== -->
      <div class="main-content">
        <div class="page-content">
          <div class="container-fluid">
            <div class="row">
              <div class="col-lg-12">
                <div class="card">
                  <div class="card-body">
                    <div class="p-lg-1">
                      <div class="d-xl-flex">
                        <div class="w-100">
                          <div>
                            <!-- intro start -->
                            <div id="introduction" class="mb-5">
                              <h4 class="mt-0 mb-4">Api integration</h4>
                              <p>
                                Doot react having fake-backend setup already.
                                you will find all files related to pai
                                integrations in
                                <code>src/api</code> folder.
                              </p>
                              <ul>
                                <li>
                                  <p class="mb-1">
                                    <code> src/apiCore </code> file contains
                                    axios setup to call server api(s) including
                                    get, put, post, patch, delete etc methods,
                                    interceptors & token set methods.
                                  </p>
                                </li>
                                <li>
                                  <p class="mb-1">
                                    <code> src/index </code> file contains all
                                    module's api call functions which are
                                    exported from each module's individual .ts
                                    file, E.g. contacts.ts, bookmarks.ts etc.
                                  </p>
                                </li>
                                <li>
                                  <p>
                                    <code> src/urls </code> file contains all
                                    module's api's url.
                                  </p>
                                </li>
                              </ul>
                              <div class="alert alert-success">
                                <strong>Note :</strong> we have added
                                <strong>Fake backend setup</strong> just for user
                                interactions, but if you are working with the
                                real api integration, then there is no need of
                                fake backend as well as the fakeBackend file located in
                                <code>src/helpers/fakeBackend.ts</code>, so you can delete it and also remove the code related to fakeBackend from app.tsx file. you
                                just need to update api's url of the related
                                module from <code>src/apiCore/urls</code> file,
                                that's it!
                              </div>
                            </div>
                            <!-- intro end -->

                            <!-- how to create start -->
                            <div id="how-to-integrate">
                              <h5>How To integrate api's new url ?</h5>
                              <p>
                                This example is created with new module's api
                                integration ? let's take an example that we want
                                to integrate api of user's profile details.
                              </p>
                              <ol>
                                <li class="mb-2">
                                  let's assume that our api's url is
                                  "..baseurl/user-profile-details/{userId}". so implement it, first we have to
                                  add this url in
                                  <code>src/apiCode/urls.ts</code> file, so open
                                  the file and add the following code.
                                  <div class="mt-1">
                                    <pre class="bg-dark text-white p-3">
...
export const USER_PROFILE_DETAILS = "/user-profile-details";</pre
                                    >
                                  </div>
                                </li>
                                <li class="mb-2">
                                  if this is a new module of your app, then
                                  create a new .ts file in
                                  <code>src/apiCore/</code> folder named <code>userProfile.ts</code> and
                                  write following code in it.
                                  <div class="mt-1">
                                    <pre class="bg-dark text-white p-3">
import { APIClient } from "./apiCore";
import * as url from "./urls";

const api = new APIClient();
                                      
const getUserDetails = (userId : number | string) => {
  return api.get(`${url.USER_PROFILE_DETAILS}/${userId}`);
};

export { getUserDetails };
</pre
                                    >
                                  </div>
                                  do not forget to export newly created file's
                                  content (userProfile.ts) in index.ts file,
                                  let's do this.
                                  <div class="mt-1">
                                    <pre class="bg-dark text-white p-3">
...
export * from "./userProfile";
</pre
                                    >
                                  </div>
                                </li>
                                <li class="mb-2">
                                  after the api's setup, the next we will do
                                  redux action's setup. To do this, please check
                                  <a href="redux.html"
                                    >How To Create Actions & Saga</a
                                  > first.
                                  <p class="mb-0">
                                    Create a folder named with your module in
                                    <code>src/redux</code> folder and then
                                    create actions.ts, saga.ts, reducer.ts &
                                    actionTypes.ts files and follow the pattern
                                    of other modules added in this template.
                                    Also do not forget to export it in main actions, sagas & reducers files located in <code>src/redux/</code> folder.
                                  </p>
                                </li>
                                <li class="mb-2">
                                  Add your action name in the actionTypes.ts
                                  file. E.g.
                                  <div class="mt-1">
                                    <pre class="bg-dark text-white p-3">
export enum UsersActionTypes {
  GET_USER_PROFILE_DETAILS = "@@users/GET_USER_PROFILE_DETAILS",
}

export enum UsersState {
  userDetails : object
}
</pre
                                    >
                                  </div>
                                </li>
                                <li class="mb-2">
                                  Create the action in the action.ts file. And
                                  make sure you pass the same action type as a
                                  <strong>type</strong> parameter which you
                                  added in <code>actionTypes.ts</code> file.
                                  <div class="mt-1">
                                    <pre class="bg-dark text-white p-3">
import { UsersActionTypes } from "./types";

// common success
export const usersApiResponseSuccess = (actionType: string, data: any) => ({
  type: UsersActionTypes.API_RESPONSE_SUCCESS,
  payload: { actionType, data },
});

// common error
export const usersApiResponseError = (actionType: string, error: string) => ({
  type: UsersActionTypes.API_RESPONSE_ERROR,
  payload: { actionType, error },
});

export const getUserDetails = (userId : string | number) => {
  return {
    type: UsersActionTypes.GET_USER_PROFILE_DETAILS,
    payload: userId
  }
}
</pre
                                    >
                                  </div>
                                </li>
                                <li class="mb-2">
                                  Add your action to the
                                  <strong>reducer.ts</strong> as well. Here, we
                                  can have either success or error response from
                                  the api. so we will manage this by
                                  API_RESPONSE_SUCCESS & API_RESPONSE_ERROR
                                  actions.
                                  <div class="mt-1">
                                    <pre class="bg-dark text-white p-3">
import { UsersActionTypes, UsersState } from "./types"
        
const INIT_STATE : UsersState = {
  userDetails: {},
}
        
const User = (state = INIT_STATE, action: any) => {
  switch (action.type) {
    case UsersActionTypes.API_RESPONSE_SUCCESS:
      switch (action.payload.actionType) {
        case UsersActionTypes.GET_USER_PROFILE_DETAILS:
          return {
            ...state,
            userDetails: action.payload.data,
            isDetailsFetched: true,
            getDetailsLoading: false,
          };
        default:
          return { ...state };
      }

    case UsersActionTypes.API_RESPONSE_ERROR:
      switch (action.payload.actionType) {
        case UsersActionTypes.GET_USER_PROFILE_DETAILS:
          return {
            ...state,
            error : action.payload.error,
            isDetailsFetched: false,
            getDetailsLoading: false,
          };

        default:
          return { ...state };
      }

    case UsersActionTypes.GET_USER_PROFILE_DETAILS: {
      return {
        ...state,
        getDetailsLoading: true,
        isDetailsFetched: false,
      };
    }
            
    default:
      return { ...state }
    }
}
        
export default User
</pre
                                    >
                                  </div>
                                </li>
                                <li class="mb-2">
                                  Now, create saga.ts file and Add saga funtion
                                  & watchers for the action.

                                  <div class="mt-1">
                                    <pre class="bg-dark text-white p-3">
import { takeEvery, fork, put, all, call } from "redux-saga/effects";

// Login Redux States
import { UsersActionTypes } from "./types";
import { usersApiResponseSuccess, usersApiResponseError } from "./actions";
                                      
import { getUserDetails as getUserDetailsApi } from "../../api/index";

function* getUserDetails({ payload: userId }: any) {
  try {
    const response: Promise<any> = yield call(getUserDetails, userId);
    yield put(usersApiResponseSuccess(UsersActionTypes.GET_USER_PROFILE_DETAILS, response));
  } catch (error: any) {
    yield put(usersApiResponseError(UsersActionTypes.GET_USER_PROFILE_DETAILS, error));
  }
}
                                      
export function* watchGetUserDetails() {
  yield takeEvery(UsersActionTypes.GET_USER_PROFILE_DETAILS, getUserDetails);
}
                                      
function* usersSaga() {
  yield all([fork(watchGetUserDetails)]);
}
                                      
export default usersSaga;</pre>
                                  </div>
                                </li>
                                <li>
                                  after redux & saga's setup, you just need to call the action from your component. E.g.
                                  <pre class="bg-dark text-white p-3">
import React from 'react';
import React, { useEffect, useState } from "react";

//redux
import { useSelector, useDispatch } from "react-redux";

// actions
import { getUserDetails } from "../../../redux.actions";

interface IndexProps {}
                                    
const Index = (props: IndexProps) => {
  const dispatch = useDispatch();
  const { userDetails } = useSelector((state: any) => ({
    userDetails: state.User.userDetails,
  }));

  /*
  get user derails, here, userId = 2
  */
  useEffetct(() => {
    dispatch(getUserDetails(2))
  },[dispatch]);

  // your api's response data will be in userDetails variable.
  console.log(userDetails);

  return (
    &lt;div&gt;
    &lt;/div&gt;
  );
}
                                    
export default Index;</pre
                                                                    >
                                </li>
                              </ol>
                            </div>
                          </div>
                        </div>
                        <!-- Start right-side-nav -->
                        <div class="d-none d-xl-block">
                          <div class="right-side-nav">
                            <ul class="nav nav-pills flex-column">
                              <li class="nav-item">
                                <a href="#introduction" class="nav-link"
                                  >Introduction</a
                                >
                              </li>
                              <li class="nav-item">
                                <a href="#how-to-integrate" class="nav-link"
                                  >How to Create Actions With Saga</a
                                >
                              </li>
                            </ul>
                          </div>
                        </div>

                        <!-- End right-side-nav -->
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <!-- end row -->
          </div>
          <!-- container-fluid -->
        </div>
        <!-- End Page-content -->

        @@include("partials/footer.html")
      </div>
      <!-- end main content-->
    </div>
    <!-- END layout-wrapper -->

    @@include("partials/vendor-scripts.html")

    <script src="assets/js/app.js"></script>
  </body>
</html>
